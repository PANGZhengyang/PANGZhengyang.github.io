---
layout: post
title: "分箱"
date: 2022-06-12
description: "分箱"
tag: 风控
katex: true
---

分箱（Binning）就是将连续型变量离散化。

分箱的数量不宜太过稀疏，在评分卡中通常划分4-5个bin。

## 优点

1. 对异常数据有较强的鲁棒性
2. 增加了非线性，对于风控评分卡常用的逻辑回归（广义线性）增加了非线性的，可以提升模型表达能力

## 分类

1. **等频**

2. **等宽**

3. **聚类（K-means）**

4. **CART决策树分箱**

   该算法是**基于最小基尼指数递归的方式选择最优的二值划分点**，不断地把数据集划分成D1和D2两部分，依此类推直到满足停止条件。所以连续分箱也是可以借助相同的理论来使用，其实现步骤如下：
   1）给定连续变量 V，对V中的值进行排序；
   2）依次计算相邻元素间中位数作为二值划分点的基尼指数；
   3）选择最优（**划分后基尼指数下降最大**）的划分点作为本次迭代的划分点；
   4）递归迭代步骤2-3，直到满足停止条件。（一般是以划分后的样本量作为停止条件，比如叶子节点的样本量>=总样本量的10%）

5. **卡方分箱（ChiMerge）**

   该方法是基于卡方分布，计算卡方值（表示两个数据集的差异），**算出来的卡方值越小，就越证明这两个数据集是同一类，可以合并**。分成2阶段初始化阶段和自底向上合并阶段，实现步骤如下：

   1）给定连续变量 V，对V中的值进行排序，然后每个元素值单独一组，完成初始化阶段；
   2）对相邻的组，两两计算卡方值；
   3）合并卡方值最小的两组；
   4）递归迭代步骤2-3，直到满足停止条件。（一般是卡方值都高于设定的阈值，或者达到最大分组数等）

   

   