---
layout: post
title: "假设检验例子"
date: 2021-03-20
description: "假设检验"
tag: 统计
katex: true
---

## 单侧检验

假设某咖啡标签上标明有3磅咖啡，某检测机构认为该咖啡生产线不可能精确地在每罐中放入3磅咖啡，甚至无法保证所有听装咖啡重量的总体均值为3磅 / 听。现使用假设检验来验证。

**第一步**：提出原假设和备择假设

总体均值$\mu_0$ = 3
$$
H_0:\mu \geq 3 \ \ \ H_1: \mu <3
$$
**第二步：** 确定显著性水平 $\alpha$ ：$\alpha$ = 0.01

显著性水平表示犯第一类错误的概率

**第三步：** 根据样本计算检验统计量，从而得出p-value

假定选定36听咖啡组成一个随机样本，根据之前检验可得到总体标准差为$\sigma$ = 0.18

总体标准差已知的单样本假设检验：使用 z 检验统计量
$$
z = \frac{\overline x - \mu_0}{\frac{\sigma}{\sqrt {n}}} = \frac {\overline x - 3}{0.03}
$$
根据样本计算得到$\overline x$ = 2.92，代入上式计算得到：z = -2.67

又因为z统计量的抽样分布是标准正态分布，故可以求得p-value = 0.0038

![2021-03-20-hypothesis-test-detail-1](\assets\statistic\2021-03-20-hypothesis-test-detail-1.png)

所以从$\mu$=3的总体中抽出均值为2.92的样本的概率为0.0038，且小于显著性水平0.01，是不可能发生的，故可以拒绝原假设（他发生第一类错误的概率我们已经控制住了）

这个是一个左侧检验，下面来看看双侧检验p-value的使用。

## 双侧检验

$$
H_0:\mu = 3 \ \ \ H_1: \mu \neq3
$$

上述属于双侧，确定好显著性水平，计算检验统计量

如果检验统计量的值位于右侧（z>0），计算右侧面积；相反，如果检验统计量的值位于左侧（z<0），计算左侧面积

**将上述计算出的概率（面积）乘以2即可得到p-value**

## 卡方检验

探究喝牛奶对感冒发病率有没有影响。

|   实际值   | 感冒人数 | 未感冒人数 | 合计 | 感冒率 |
| :--------: | :------: | :--------: | :--: | :----: |
|  喝牛奶组  |    43    |     96     | 139  | 30.94% |
| 不喝牛奶组 |    28    |     84     | 112  | 25.00% |
|    合计    |    71    |    180     | 251  | 28.29% |

假设喝不喝牛奶和感冒与否并没有显著性关系，所以期望的人群感冒率每个组都应该是
$$
\frac{43+28}{43+28+96+84} = 28.29 \%
$$
所以对于上述的试验对象，可以得到每个格子中的期望值

|   实际值   |      感冒人数       |        未感冒人数         | 合计 | 感冒率 |
| :--------: | :-----------------: | :-----------------------: | :--: | :----: |
|  喝牛奶组  | 139 * 28.29% = 39.3 | 139 * (1 - 28.29%) = 99.7 | 139  | 28.29% |
| 不喝牛奶组 | 112 * 28.29% = 31.7 | 112 * (1 - 28.29%) = 80.3 | 112  | 28.29% |
|    合计    |         71          |            180            | 251  | 28.29% |

计算卡方值：
$$
\chi^2 = \sum \frac{A-E}{E} = \frac{(43-39.3)^2}{39.3} + \frac{(96-99.7)^2}{99.7}+\frac{(28-31.7)^2}{31.7}+\frac{(84-80.3)^2}{80.3} = 1.07
$$
计算自由度：
$$
k = (R-1)(C-1) = (2-1)(2-1) = 1
$$
计算p-value：

根据卡方表可以求得p=0.3，大于0.05，不能拒绝原假设，喝不喝牛奶和感冒与否没有显著性关系。

